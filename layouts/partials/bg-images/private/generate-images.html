{{/*


  context:
  .page - page context
  .src - page resource file string
  .width - resize width integer
*/}}
{{- /*
  bg-images/private/generate-images.html
  Generates original and webp format images based on image and width input.

  @author @sean-au

  @context
    .image
      .src - page resource file string
      .ctx - page context
    .width - resize width integer

  @returns dict:
    .original - original format image
    .webp - webp format image

  @access private

  @example - Hugo Template
  {{- $resized := partial "bg-images/private/generate-images" (dict "image" $image "width" $width) }}

*/ -}}

{{ $img := .image.ctx.Resources.GetMatch .image.src }}
{{ $original := $img.Resize (printf "%vx" .width ) }}
{{ $webp := $img.Resize (printf "%vx webp" .width ) }}
{{ $lqip := false }}
{{ if eq .image.placeholder "lqip"}}
  {{ $lqip = $img.Resize (printf "%vx gif" 400) }}
  {{ $lqip = $lqip.Filter (images.GaussianBlur 5) }}
  {{ $lqip = $lqip.RelPermalink }}
{{ end }}
{{ return (dict "original" $original "webp" $webp "lqip" $lqip) }}
