{{/*
  bg-images/private/sanitize-inputs.html 
  Sanitizes user inputs and returns error messages

  @author @sean-au

  @context (dict)
    "ctx" (object) - page context
    "src" (string) - page resource relative path
    "selector" (string) - css selector
    "widths" (array of ints) - array of resize widths
    "lazy" (bool) - lazy load setting
    )

  @access private

  @example - Go Template
    {{ partial "bg-images/private/validate-variables" (merge . (dict "ctx" $ctx)) }}

*/}}
{{ $error_ctx := dict 
  "page" .ctx 
  "img" (.ctx.Resources.GetMatch .src)
  "element" "bg-image"
  "module" "Hugo Responsive Background Images"}}

{{ with .src }}
  {{/* FIX THIS SECTION NOT WORKING */}}
  {{ $img := $.ctx.Resources.GetMatch . }}
  {{ if not $img }}
    {{ partial "bg-images/private/utils/options-error" (dict 
    "var" "src"
    "val" .
    "opts" "an image resource relative path string"
    "ctx" $error_ctx
    ) }}
  {{ end }}
{{ else }}
  {{ partial "bg-images/private/utils/options-error" (dict "var" "src" "ctx" $error_ctx) }}
{{ end }}

{{ with .selector }}
  {{ if ne (printf "%T" .) "string" }}
    {{ partial "bg-images/private/utils/options-error" (dict 
      "var" "selector"
      "val" .
      "opts" "a css selector string"
      "ctx" $error_ctx
    ) }}
  {{ end }}
{{ else }}
  {{ partial "bg-images/private/utils/options-error" (dict 
  "var" "selector"
  "ctx" $error_ctx
  ) }}
{{ end }}

{{ with .widths }}
  {{ if reflect.IsSlice . }}
    {{ range . }}
      {{ if ne (printf "%T" .) "int" }}
        {{ partial "bg-images/private/utils/options-error" (dict 
          "var" "widths slice item"
          "val" .
          "opts" "an integer in a slice"
          "ctx" $error_ctx
        ) }}
      {{ end }}
    {{ end }}
  {{ else }}
    {{ partial "bg-images/private/utils/options-error" (dict 
    "var" "widths"
    "val" .
    "opts" "a slice of integers"
    "ctx" $error_ctx
  ) }}
  {{ end }}
{{ end }}

{{ with .lazy }}
  {{ if ne . true }}
    {{ partial "bg-images/private/utils/options-error" (dict 
    "var" "lazy"
    "val" .
    "opts" "true or false"
    "ctx" $error_ctx
  ) }}
  {{ end }}
{{ end }}

{{ with .placeholder }}
  {{ if ne (printf "%T" .) "string"  }}
    {{ partial "bg-images/private/utils/options-error" (dict 
    "var" "placeholder"
    "val" .
    "opts" "a string of either lqip, dominant or a css color code"
    "ctx" $error_ctx
  ) }}
  {{ end }}
{{ end }}
