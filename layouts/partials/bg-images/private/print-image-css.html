{{- /*
  bg-images/private/print-image-css.html
  Prints image css with breakpoints

  @author @sean-au

  @context dict:
    - src: image.jpg 
      selector: .selector
      widths: [500, 900] 
      page: {page context}

  @access private

  @example - Hugo Template
  {{ partial "bg-images/private/print-image-css" $variables.images }}

*/ -}}
{{-  range $page := . }}
  /* Page: {{ $page.ctx.RelPermalink }} */
  {{- range $index, $width := sort $page.widths }}
    {{- $resized := partial "bg-images/private/generate-images" (dict "page" $page.ctx "width" $width "src" $page.src) }}
    {{- $params := (dict
      "original" $resized.original
      "webp" $resized.webp
      "selector" $page.selector
      "lazy" $page.lazy
      "bg_color" $page.bg_color ) }}
    {{- if eq $index 0 }}
    {{- /* first width */ -}}
    @media (max-width: {{ $width }}px) {
      {{ partial "bg-images/private/css-images" $params }}
    }
    {{- else if (ne (add $index 1) (len $page.widths)) }}
    {{- /* inter widths */ -}}
    {{- $prev_width := index $page.widths (sub $index 1) -}}
    @media (min-width: {{ add 1 $prev_width }}px) and (max-width: {{ $width }}px) {
      {{ partial "bg-images/private/css-images" $params }}
    }
    {{- else }}
    {{- /* last width */ -}}
    {{- $prev_width := index $page.widths (sub $index 1) -}}
    @media (min-width: {{ add 1 $prev_width }}px) {
      {{ partial "bg-images/private/css-images" $params }}
    }
    {{- end }}
  {{- end }}
{{- end }}
